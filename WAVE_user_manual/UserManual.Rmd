---
title: "Masters Thesis"
author: "Nick Zinck"
date: "May 2017"
output: 
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
bibliography: "F:/Nick Zinck/Shiny Water Quality/Thesis/Thesis.bib"

nocite: | 
  @noauthor_shiny_nodate, @noauthor_shiny_nodate-1
---

```{r loadpack, include=FALSE}
# Load Packages
library(rmarkdown)
library(knitr)
library(tidyverse)
library(shiny)
library(kableExtra)
require(DiagrammeR)
require(DiagrammeRsvg)
require(rsvg)
#library(RefManageR)

```

```{r enter data,include=FALSE}
pdf_digraph <- function(filename, code, width = 500, height = NULL){
  capture.output({
  g <- grViz(paste("digraph{", code, "}"))
  DiagrammeRsvg::export_svg(g) %>% charToRaw %>% rsvg::rsvg_pdf(filename, width = width, height = height)
  },  file='NUL')
  knitr::include_graphics(filename)
}
```


# WAVE User Manual

The Drinking Water Supply Protection Analysis Application (DWSPA) should be set up on ones computer per the DWSPA Setup Manual prior to attempting to start the App.

## OVerview

This application purpose is to facilitate the searching, visualization, and analysis of water quality data. The Application allows for easy visualization and analysis of water quality temporal trends, parameter correlation, geospatial trends, and other data visualization and analysis. The application can also be used to just view data in an easier more simpler format than in the Access databases with maps to help identify the site locations. The application can be used as a means to filter and export data for outside use. This application is flexible in that features can be added and modified as new needs become apparent.

## How it works

The DWSPA App is created with RStudio's Shiny free software. Shiny is a package in R that enables an App creator to use the R programming language to create an application that consists of a front-end HTML and JavaScript user interface in which the user interacts with the data. Shiny video and written tutorials [@____] are a great resource on how Shiny works. The Application fetches data that is in the Access Databases stored on the internal network. Upon starting the App, the App will fetch the latest data that is in the databases. The App Code is stored on Github which is an open source code sharing site. The latest Shiny Application code on Github is ran every time the App is opened. The Code that is on Github should be the most up-to-date working code that the App builders have sent to Github.

Shiny's components that the user can see consists of two categories: Input objects and Output Objects. Input objects essentially allow the user to communicate with the App and the  output objects are the App communicate with the User. input objects will be refered to as Input Widgets in this user manual and can take the form of checkboxs, selection drop-down lists, and Date Range Calendar inputs. The full list of Shiny Widgets can be seen in the Shiny Widget Gallery (@) . Output objects include plots, tables, maps, images, and tables. Shiny takes the input of from the user and executes code which are essentially directions for a sequence of computations and other operations to create the outputs that the user sees.

The Shiny Widget Gallery shows all of the available widgets in Shiny in an operational form. The 


## Startup

To open the DWSPA App, the user must double click on the DWSPA icon. A message will appear to notify the user that the App is opening and may take up to 30 seconds. The user may press okay to exit or the user may just leave the message alone, neither will not effect the speed at which the App opens. When the App is ready, it will open in the default web browser. Once the browser window opens, the user should wait until the map appears on the screen which indicates that all the data is loaded into the Application. This may take an additional ten seconds. The browser's zoom options can be used to adjust the size of the Application, similar to any website page.

## Home

The App is defaulted to open to the Home Tab. The home tab displays a satellite map which shows the location of the sampling sites. The site locations are represented by circles which are colored based on the watershed or reservoir that they are located in. One can navigate the map by panning the screen as well as zooming in and out of the map. One can hover over the circles to display the sampling site name. One can click on the circle to display more information about the site. This information includes "_________"


The sampling sites shown on the map are taken from the site tables in the Wachusett and Quabbin Water Quality Databases. If a sampling site is not shown the likely cause is that the site is not documented in one of the site tables in the database or that it is documented with the incorrect latitude and longitude coordinates. 


## Filter

The filter tab allows for the user to filter the water quality data that is presented in the rest of the App. This would be done if the user has a specific purpose of the session and knows that he/she will be using only a part of the data. In most of the other tabs in the App, there will be an option to use this filtered dataset instead of the full dataset. Choosing to use the filtered dataset will send only the . Any Location, Parameter, and Data selection widgets will now only display the categories that are 

The filter options includes three different temporal filters: a date range, a month selection, and a year selection. The date range selection is in the form of a calendar date range selection in which the user selects the desired starting and ending date of the dataset. The month and year selection allows the user to select the months or years of interest. All of these temporal filters are compounding and filter independently. For example, if a user selects the following: Date Range of 2010-01-01 to 2015-01-01, the Month of "May", and the year "2012"; this will result in data only for May of 2012. The user should be aware of situations in which there is less data than maybe expected, when the date range and year do not agree. For example, if a user selects the following Date Range of 2010-01-01 to 2015-01-01, and the year "2017"; this will result in no data selected.

The user can also filter the data by flags, storm sample, and meteorological conditions.

## Tributary

The Tributary tab allows the user to query, visualize, and analyze tributary sampling data. This tab has two sub-tabs called "Time-Series" and "Correlation". The "Time-Series" sub-tab allows the user to see temporal trends of water quality parameters via a plot, table, or summary statistics. The "Correlation" sub-tab allows the user to see correlations across parameters.

### Time-Series

The "Time-Series" sub-tab is further separated by watershed and shows temporal trends of the water quality parameters. The user is prompted to select the data of interest which is then displayed to the user as a plot, table, and summary statistics. 

#### Input Widgets 

The first widget the user selects is whether the user wants to use the full dataset or the filtered dataset which is determined by the filter tab. The second widget is the site location widget where the user selects the locations of interest. The locations are separated into location categories based on the categories in the database. The primary locations are always shown, while the sites in the other categories can be toggled to be displayed or hidden. Once a site is selected it appears as a red circle in the minimal, rather than a blue circle.

The Parameter Widget displays all the parameters that the data has based on the site selected. The parameter list updates each time a site location is added or removed to the list. The Date Range Widget is programmed to display the earliest and latest dates of the data corresponding to the selected site locations. The User can use the calendar view to select the desired date range of the data. 



### Correlation

The "Time-Series" sub-tab shows . This tab is further separated by watershed. 


## Reservoir - Bacteria
### Time-Series

The "Time-Series" sub-tab is identical in nature to the "Time-Series" sub-tab in the "Tributary" tab. This tab differs in the data it uses, yet the underlying code is the same. See Section ___ for more information.

### Correlation

The "Correlation" sub-tab is identical in nature to the "Time-Series" sub-tab in the "Tributary" tab. This tab differs in the data it uses, yet the underlying code is the same. See Section ___ for more information.

## Reservoir - Physiochemical
### Time-Series

The "Time-Series" sub-tab is identical in nature to the "Time-Series" sub-tab in the "Tributary" tab. This tab differs in the data it uses, yet the underlying code is the same. See Section ___ for more information.

### Correlation

The "Correlation" sub-tab is identical in nature to the "Time-Series" sub-tab in the "Tributary" tab. This tab differs in the data it uses, yet the underlying code is the same. See Section ___ for more information.

## Reservoir - Profile
### Time-Series
### Correlation
## MapPlot
## Forestry
## Hydro/Met
## Report


# References
